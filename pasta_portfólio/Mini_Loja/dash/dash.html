<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Simples</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="style.css">
  <!-- Firebase (compat) and DB service for metrics -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="../../services/firebase/config.js"></script>
  <script src="../../services/firebase/index.js"></script>
  <script src="../../services/firebase/crud.js"></script>
</head>
<body>
  <nav>
    <div class="logo">
      <h2>Meu Dashboard</h2>
      <p>Painel Administrativo</p>
    </div>
    
   <ul>
  <li><a href="#" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
  <li><a href="./usuarios/usuarios.html"><i class="fas fa-users"></i> Usuários</a></li>
  <li><a href="./vendas/vendas.html"><i class="fas fa-shopping-cart"></i> Vendas</a></li>
  <li><a href="./Relatórios/Relatórios.html"><i class="fas fa-chart-bar"></i> Relatórios</a></li>
  <li><a href="./Configurações/Configurações.htm"><i class="fas fa-cog"></i> Configurações</a></li>
  <li><a href="../mini_loja.html" class="active"><i class="fas fa-store"></i> Loja Virtual</a></li>
</ul>
  </nav>

  <main>
    <div class="header">
      <h1>Dashboard</h1>
      <div class="user-info">
        <div>
          <p>João Silva</p>
          <span>Administrador</span>
        </div>
        <img src="https://www.bing.com/images/search?view=detailV2&ccid=4HDfBQSh&id=F4A9982DA360D0C636F02CBE4FE731A54C2F853B&thid=OIP.4HDfBQShtO9YEMeLix22QwHaE5&mediaurl=https%3a%2f%2fpng.pngtree.com%2fbackground%2f20230326%2foriginal%2fpngtree-the-businessman-working-in-the-office-businessman-working-in-the-office-picture-image_2174689.jpg&cdnurl=https%3a%2f%2fth.bing.com%2fth%2fid%2fR.e070df0504a1b4ef5810c78b8b1db643%3frik%3dO4UvTKUx50%252b%252bLA%26pid%3dImgRaw%26r%3d0&exph=793&expw=1200&q=imagem+de+pessoa+trabalhando&FORM=IRPRST&ck=A4DD4CBF66FF980B07DB7B871AF27462&selectedIndex=6&itb=0" alt="Usuário">
      </div>
    </div>

    <div class="cards">
      <div class="card">
        <div class="icon">
          <i class="fas fa-users"></i>
        </div>
        <h3>Usuários</h3>
        <p id="totalUsuarios">0</p>
      </div>
      <div class="card">
        <div class="icon">
          <i class="fas fa-shopping-cart"></i>
        </div>
        <h3>Vendas</h3>
        <p id="totalVendas">0</p>
      </div>
      <div class="card">
        <div class="icon">
          <i class="fas fa-dollar-sign"></i>
        </div>
        <h3>Receita</h3>
        <p id="receitaTotal">R$ 0,00</p>
      </div>
      <div class="card">
        <div class="icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <h3>Crescimento</h3>
        <p id="crescimento">0%</p>
      </div>
    </div>

    <div class="dashboard-content">
      <div class="chart-container">
        <h3>Vendas Mensais</h3>
        <canvas id="myChart" width="400" height="200"></canvas>
      </div>
      
      <div class="side-panel">
        <div class="activity">
          <h3>Atividade Recente</h3>
          <div class="activity-item">
            <div class="activity-icon" style="background-color: #0abde3;">
              <i class="fas fa-user-plus"></i>
            </div>
            <div class="activity-info">
              <p>Novo usuário registrado</p>
              <span>Há 5 minutos</span>
            </div>
          </div>
          <div class="activity-item">
            <div class="activity-icon" style="background-color: #10ac84;">
              <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="activity-info">
              <p>Nova venda realizada</p>
              <span>Há 15 minutos</span>
            </div>
          </div>
          <div class="activity-item">
            <div class="activity-icon" style="background-color: #ee5253;">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="activity-info">
              <p>Problema no sistema resolvido</p>
              <span>Há 1 hora</span>
            </div>
          </div>
          <div class="activity-item">
            <div class="activity-icon" style="background-color: #ff9f43;">
              <i class="fas fa-file-alt"></i>
            </div>
            <div class="activity-info">
              <p>Relatório mensal gerado</p>
              <span>Há 2 horas</span>
            </div>
          </div>
        </div>
        
        <div class="recent-users">
          <h3>Usuários Recentes</h3>
          <div class="user-item">
            <img src="https://i.pravatar.cc/150?img=1" alt="Usuário">
            <div class="user-info">
              <p>Maria Santos</p>
              <span>Designer</span>
            </div>
          </div>
          <div class="user-item">
            <img src="https://i.pravatar.cc/150?img=5" alt="Usuário">
            <div class="user-info">
              <p>Pedro Oliveira</p>
              <span>Desenvolvedor</span>
            </div>
          </div>
          <div class="user-item">
            <img src="https://i.pravatar.cc/150?img=8" alt="Usuário">
            <div class="user-info">
              <p>Ana Costa</p>
              <span>Gerente</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    const ctx = document.getElementById('myChart').getContext('2d');
    const myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho'],
        datasets: [{
          label: 'Vendas Mensais',
          data: [12, 19, 8, 15, 10, 17],
          backgroundColor: '#0abde3',
          borderRadius: 5,
          borderSkipped: false,
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { 
            display: false 
          },
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.7)',
            titleFont: { size: 14 },
            bodyFont: { size: 14 },
            padding: 10,
          }
        },
        scales: {
          y: { 
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            }
          },
          x: {
            grid: {
              display: false
            }
          }
        }
      }
    });
  </script>
  <script>
    // Load basic metrics from Firebase if available
    (async function(){
      if (!(window.DB && window.DB.ready)) return;
      try {
        const usuarios = await window.DB.list('usuarios');
        const vendas = await window.DB.list('vendas');
        const totalUsuarios = usuarios.length;
        const totalVendas = vendas.length;
        const receita = vendas.reduce((sum, v) => sum + Number(v.total ?? 0), 0);
        const crescimento = totalVendas > 0 ? '12.5%' : '0%';
        const setText = (id, text) => { const el = document.getElementById(id); if (el) el.textContent = text; };
        setText('totalUsuarios', String(totalUsuarios));
        setText('totalVendas', String(totalVendas));
        setText('receitaTotal', `R$ ${receita.toFixed(2)}`);
        setText('crescimento', crescimento);
      } catch(e) { console.warn('[Dashboard] Firebase metrics failed:', e); }
    })();
  </script>
</body>
</html>
